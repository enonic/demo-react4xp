= Hello React4XP
:toc: right
:experimental:
:imagesdir: media/
:sourcedir: ../src/main/resources/
:snippet: ../code-samples/code-snippets/

Linking React4XP to your content - and how it works

== Movie DB dataset

This tutorial is dedicated to front-end development. To make it as compact as possible, the https://market.enonic.com/vendors/enonic/headless-movie-site[Headless Movie DB] dataset was installed in the setup. This contains several pre-defined content schemas as well as sample content and mock previews. We'll be using this dataset extensively throughout the tutorial.

To learn about content modeling, visit our https://developer.enonic.com/start[getting started guide^], or the https://developer.enonic.com/docs/developer-101[developer 101 tutorial^].

== Add app to site

Follow these steps to make your application a front-end for the Headless Movie DB.

. Visit http://localhost:8080/admin^[localhost:8080/admin]. Log in and open Content Studio.
+
. The "Headless Movie Database" project should automatically be visible
+
. Select the root item in the tree structure, and click btn:[Edit]. You should see something like this:
+
image:hmdb.png[title="HMDB welcome page",width=900px]
+
. Add your brand new `React4XP Starter` application to the site. After saving, the preview will refresh, to reveal something like this:
+
image:hello.png[title="React4XP Starter page",width=900px]

The component was initially rendered on the server, then <<appendix/hydration#, hydrated>> to spin up as a client-side React component.

TIP: Click `Preview` and try pressing the button for some React action.


== A look at the code

What just happened?

By adding the application to the site, it is injected into Enonic's standard rendering - aka the Site Engine. Here, it basically hijacks the rendering - taking presdence over HMDB's built-in preview.

Let's have a look at the code:

=== Hello component

The component that rendered the page is very simple:

.react4xp/hello/components/Hello.tsx
[source,TypeScript]
----
include::{sourcedir}react4xp/components/hello/Hello.tsx[]
----

It takes a single parameter, HelloProps. The type is declared like this:

[source,TypeScript]
----
export interface HelloProps extends Record<string, unknown>{
    title: string
    initialCount: number
}
----

NOTE: Typing your props is optional, but recommended for more robust code.

=== Data Processor

A data processor is used to fetch the props:

.react4xp/components/hello/HelloProcessor.ts
[source,TypeScript]
----
include::{sourcedir}react4xp/components/hello/HelloProcessor.ts[]
----

This processor does not execute by itself, it must be registered in the dataFetcher. 

NOTE: The dataFetcher solely executes on the server side.

The dataFetcher will only invoke a processor if needed, in our case when a content of type `portal:site` (the site content) is rendered.

.react4xp/dataFetcher.ts
[source,TypeScript]
----
import {DataFetcher} from '/lib/enonic/react4xp';
import {helloProcessor} from './components/HelloProcessor';

export const dataFetcher = new DataFetcher();

dataFetcher.addContentType('portal:site', { processor: helloProcessor }); // <1>
----

<1> helloProcessor is mapped to the content type `portal:site`, which means it will be executed whenever the URL matches a site content.

=== Component Registry

Back to the Hello React component. Similar to the dataFetcher, this must be added to the ComponentRegistry in order to work.

.react4xp/componentRegistry.tsx
[source,TypeScript]
----
import {ComponentRegistry} from '@enonic/react-components';
import {Hello} from './components/Hello';

export const componentRegistry = new ComponentRegistry();

componentRegistry.addContentType('portal:site', { View: Hello }); //<1>
----

<1> The Hello component is mapped to the content type `portal:site`, which means it will be executed whenever the URL matches a site content.

Try clicking other content items in Content Studio, and you should simply see an error message at this point.

TIP: Dive deeper by learning how the basic boot-strapping and routing works in the <<appendix/controller#, app controller documentation>>.

== Next up

Great, you rendered your first page, let's check out <<common#, common processors and components>>.

