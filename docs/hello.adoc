= Hello React4XP
:toc: right
:imagesdir: media/
:sourcedir: ../src/main/resources/
:snippet: ../code-samples/code-snippets/

Your first React4XP page - and how it works

== Movie DB dataset

This tutorial is dedicated to front-end development. To make it as compact as possible, we have pre-installed an application called the https://market.enonic.com/vendors/enonic/headless-movie-site[Headless Movie DB]. It contains pre-defined CMS schemas as well as sample content and previews. We'll be using this dataset extensively throughout the tutorial.

Visit our https://developer.enonic.com/start[getting started guide^], or the https://developer.enonic.com/docs/developer-101[developer 101 tutorial^] to learn about schemas and content creation.

== Add app to site

Follow these steps to make your application a front-end for the Headless Movie DB.

. Visit http://localhost:8080/admin^[localhost:8080/admin]. Log in and open Content Studio.
+
. The "Headless Movie Database" project should automatically be visible
+
. Select the root item in the tree structure, and you should see something like this:
+
image:hmdb.png[title="HMDB welcome page",width=900px]
+
. Click btn:[Edit], and connect your React4xp app to the site.
+
image:add-to-site.png[title="Add React4XP application to the site", width=647px]
+
After saving, the preview should change to something like this:
+
image:hello.png[title="React4XP starter page", width=647px]


== A look at the code

What happened?

By adding the application to the site, it is injected into the Site Engine's request pipeline - it basically hijacks the rendering - taking presdence over HMDB's built-in preview.

Let's have a look at the code:

=== Hello component

The component that rendered the page is very simple:

.react4xp/hello/components/Hello.tsx
[source,TypeScript]
----
include::{sourcedir}react4xp/components/hello/Hello.tsx[]
----

It takes a single parameter, HelloProps. The type is declared like this:

.types/HelloProps.ts
[source,TypeScript]
----
include::{sourcedir}types/HelloProps.ts[]
----

=== Data Fetcher

To feed the Hello component with props, we can create a data processor:

.react4xp/components/hello/HelloProcessor.ts
[source,TypeScript]
----
include::{sourcedir}react4xp/components/hello/HelloProcessor.ts[]
----

The processor does not run by itself, it must be added to the dataFetcher. The dataFetcher only solely executes on the server.

The dataFetcher will only invoke a processor when needed, in our case when a site content `portal:site` is rendered.

.react4xp/dataFetcher.ts
[source,TypeScript]
----
import {DataFetcher} from '/lib/enonic/react4xp';
import {helloProcessor} from './components/HelloProcessor';

export const dataFetcher = new DataFetcher();

dataFetcher.addContentType('portal:site', { processor: helloProcessor });
----

=== Component Registry

Like processors, components must also be registered. The Hello component is added to the ComponentRegistry, also matching content of type `portal:site`.

.react4xp/componentRegistry.ts
[source,TypeScript]
----
import {ComponentRegistry} from '@enonic/react-components';
import {Hello} from './components/Hello';

export const componentRegistry = new ComponentRegistry();

componentRegistry.addContentType('portal:site', { View: Hello }); //<1>

----

<1> The Hello component is mapped to the content type `portal:site`, which means it will be executed whenever the URL matches a site content.

Try clicking other content items in Content Studio, and you should simply see an error message at this point.

TIP: Learn how the basic boot-strapping and routing works in the <<appendix/controller#, app controller section>>.

== Next

Great, you rendered your first page, next up about <<common#, common processors and components>>.

