= React4XP project starter
:toc: right
:imagesdir: media/

Build sites and apps that support server side JSX templating with the React framework

== Introduction

This documentation takes you through the basic elements of React4XP and how to use the starter

Essential features you will learn about:

* How to
* What is
* And then some...

== Create project

o setup a project locally, run the following command:

  enonic project create -r starter-react4xp

Remember to create a *new XP sandbox* when completing the project wizard.

NOTE: *Don't have the Enonic CLI?* Visit the https://developer.enonic.com/start[Getting started guide] to install it.


== Project structure

The project folder created should now contain a project structure, looking something like this:

[source,files]
----
build.gradle <--1-->
settings.gradle
build/ <--2-->
src/
  main/
    java/ <!--3-->
    resources/ <!--4-->
      assets/ <!--5-->
      webapp/ <!--6-->
----

<1> The gradle files are used by the build system
<2> Contains output files produced by the build
<3> Optional folder for Java code (used to import sample site in this starter)
<4> Main location for XP specific project code
<5> Static assets such as css and icons are placed here
<6> Folder containing the root webapp http controller

== Building and Deploying

To build and deploy the app, run this command from your shell:

  enonic project deploy

Accept starting the sandbox

[NOTE]
====
To verify that your app started successfully, you should find an entry similar to this in the sandbox log:

  2019-04-09 13:40:40,765 INFO ... Application [<name.of.your.app>] installed successfully
====


== API/Details

Bla bla, basic info and links about how react/react4XP works and what it does.


== Usage

This section contains a few examples on how you can setup and build something something..

=== Example A - Cool title

=== Example B - (title)

To see your current application:

. log in to the XP admin console (http://localhost:8080)
. open the "Applications" app, and select the listed applications
. visit the app by clicking the web app link.

video::webapp.mp4["Logging in, opening apps and launching webapp" width=1024px]


==== JS Controller

The essense of a web application is the controller.
In your project, you will find the following file:

.src/main/resources/webapp/webapp.js
[source,js]
----
exports.get = function (req) {
  var title = "Hello Web app";
  return  {
  body: `
<html>
  <head>
    <title>${title}</title>
    <link rel="stylesheet" type="text/css" href="styles.css"/>
  </head>
  <body>
      <h1>Sweet, "${title}" is working!</h1>
      <img src="html5logo.svg"/>
  </body>
</html>
`
  }
};
----

This controller file is automatically executed when your web app is being accessed.

The example above is also referencing two asset files.
These files can be found in the `src/main/resources/assets/` folder of your project.

[NOTE]
====
By default, the web app engine automatically serves files placed in the `asset/` as if they were located in the root of your web app.
====

=== Example 3 - Using Views

According to the MVC (Model View Controller) pattern,
we should separate the View (template) from the controller.
Enonic XP supports a variety of templating engines.
In this step, we'll use https://market.enonic.com/vendors/enonic/thymeleaf-lib[Thymeleaf]:

. To make sure Thymeleaf is available for our project, we must update the `gradle.build` file.
Uncomment the following line from the "dependencies" section:
+
      include "com.enonic.lib:lib-thymeleaf:2.0.0-RC1"
+
. Create a new file `hello.html` and add it to the `webapp/` folder
+
.src/main/resources/webapp/hello.html
[source,html]
----
include::../code-samples/webapp-template/hello.html[]
----
+
. Then update your controller file to use the new template:
+
.src/main/resources/webapp/webapp.js
[source,js]
----
include::../code-samples/webapp-template/webapp.js[]
----
+
. When finished, redeploy the app. NB! Just start a new shell if your current shell is running the sandbox:
+
  enonic project deploy
+

Refresh your app, and you should see the heading "*Sweet... Views are working too!*".

[TIP]
====
A cool feature related to Thymeleaf templates is that they are actually pure HTML.
Meaning they may be opened directly in your browser.
Try opening the hello.html file to see for yourself:
====

image::hello-dummy.png["Screenshot of template showing dummy heading and html5 logo",width=800px]

== Error handling

You might have noticed the "404 FTW" link in your app by now, and maybe even clicked it?
Essentially, the this url is not handled by the router, and returns the default error page.

We can do better, as XP provides a concept for generic http error handling. Lets add error handling to our app:

. Add a new controller `error.js` to your project as follows:
+
.src/main/resources/error/error.js
[source,js]
----
include::../code-samples/error/error.js[]
----
+
. Build, deploy and try out your new error handler:
+
  enonic project deploy
+


== Logging

While developing an app, it can be helpful to do some logging.
Try adding the following line into the exports.get section of your webapp controller and see what happens:

  log.info('Testing logging: %s', JSON.stringify(req, null, 4));

NOTE: A simplified logging function and many more are included in the https://market.enonic.com/vendors/enonic/util-lib[Util Library]
